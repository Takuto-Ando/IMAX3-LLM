#pragma once

#ifdef  __cplusplus
extern "C" {
#endif

extern int final_token_number;

void reset_time();
void show_time();

void monitor_time_start(int, int);
void monitor_time_end(int, int);
void show_time_sep(void);

// New function declarations for enum counting
void monitor_increment_count(int id);
void reset_enum_counts(void);
void show_enum_counts(void);

// New function declarations for tracking xmax_cpyin data transfer
void reset_cpyin_stats(void);
void count_cpyin_q3k(size_t size_bytes);
void count_cpyin_q80(size_t size_bytes);
void show_cpyin_stats(void);

typedef enum {
  T_MAIN,
  T_MAIN_WHILE,
  T_MAIN_GA_N_EQ1,
  T_MAIN_GA_N_NE1,
  T_MAIN_SESSION,
  T_MAIN_EMBD_SIZE,
  T_LLAMA_GRAPH_COMPUTE,
  T_GGML_BACKEND_SCHED_COMPUTE_SPLITS,
  T_GGML_GRAPH_COMPUTE,
  T_COMPUTE_FORWARD,
  T_COMPUTE_FORWARD_DUP,
  T_COMPUTE_FORWARD_ADD,
  T_COMPUTE_FORWARD_ADD_ID,
  T_COMPUTE_FORWARD_ADD1,
  T_COMPUTE_FORWARD_ACC,
  T_COMPUTE_FORWARD_SUB,
  T_COMPUTE_FORWARD_MUL,
  T_COMPUTE_FORWARD_DIV,
  T_COMPUTE_FORWARD_SQR,
  T_COMPUTE_FORWARD_SQRT,
  T_COMPUTE_FORWARD_LOG,
  T_COMPUTE_FORWARD_SUM,
  T_COMPUTE_FORWARD_SUM_ROWS,
  T_COMPUTE_FORWARD_MEAN,
  T_COMPUTE_FORWARD_ARGMAX,
  T_COMPUTE_FORWARD_REPEAT,
  T_COMPUTE_FORWARD_REPEAT_BACK,
  T_COMPUTE_FORWARD_CONCAT,
  T_COMPUTE_FORWARD_SILU_BACK,
  T_COMPUTE_FORWARD_NORM,
  T_COMPUTE_FORWARD_RMS_NORM,
  T_COMPUTE_FORWARD_RMS_NORM_BACK,
  T_COMPUTE_FORWARD_GROUP_NORM,
  T_COMPUTE_FORWARD_MUL_MAT,
  T_COMPUTE_FORWARD_MUL_MAT_NE_VEC_DOT,
  T_COMPUTE_FORWARD_MUL_MAT_NDIMS_EQ_2,
  T_COMPUTE_FORWARD_MUL_MAT_WHILE_CHUNK,
  T_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK,
  IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_F32,
  IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_F32_ARM,
  IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_F16,
  IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_F16_ARM,
  IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_Q2K,
  IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_Q2K_ARM,
  IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_Q3K,
  IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_Q3K_ARM,
  // IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_Q4K,
  // IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_Q4K_ARM,
  // IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_Q5K,
  // IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_Q5K_ARM,
  IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_Q6K,
  IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_Q6K_ARM,
  IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_Q80,
  IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_Q80_ARM,
  // IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_Q8K,
  // IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_Q8K_ARM,
  IMAX_COMPUTE_FORWARD_MUL_MAT_ONE_CHUNK_OTHER_ARM,
  VEC_DOT_OPERATION,
  ARM_MEMCPY,
  IMAX_CPYIN_PRELOAD,
  IMAX_CPYIN_A,
  IMAX_CPYIN_A_Q80,
  IMAX_CPYIN_B,
  IMAX_CPYIN_A_Q3K,
  IMAX_CPYIN_B_Q3K,
  IMAX_BZERO_Q3K,
  IMAX_CPYOUT_Q3K,
  IMAX_CPYIN_A_Q6K,
  IMAX_CPYIN_B_Q6K,
  IMAX_BZERO_Q6K,
  IMAX_CPYOUT_Q6K,
  IMAX_BZERO,
  IMAX_CPYOUT,
  IMAX_MEMCPY,
  IMAX_MEMCPY_A,
  IMAX_MEMCPY_B,
  IMAX_MEMCPY_C,
  IMAX_PIOCPY,
  IMAX_TERM_1,
  IMAX_TERM_2,
  IMAX_TERM_3,
  IMAX_TERM_4,
  IMAX_TERM_5,
  IMAX_TERM_6,
  IMAX_TERM_7,
  IMAX_TERM_8,
  T_COMPUTE_FORWARD_MUL_MAT_ID,
  T_COMPUTE_FORWARD_OUT_PROD,
  T_COMPUTE_FORWARD_SCALE,
  T_COMPUTE_FORWARD_SET,
  T_COMPUTE_FORWARD_CPY,
  T_COMPUTE_FORWARD_CONT,
  T_COMPUTE_FORWARD_RESHAPE,
  T_COMPUTE_FORWARD_VIEW,
  T_COMPUTE_FORWARD_PERMUTE,
  T_COMPUTE_FORWARD_TRANSPOSE,
  T_COMPUTE_FORWARD_GET_ROWS,
  T_COMPUTE_FORWARD_GET_ROWS_BACK,
  T_COMPUTE_FORWARD_DIAG,
  T_COMPUTE_FORWARD_DIAG_MASK_INF,
  T_COMPUTE_FORWARD_DIAG_MASK_ZERO,
  T_COMPUTE_FORWARD_SET_ROWS,
  T_COMPUTE_FORWARD_GLU,
  T_COMPUTE_FORWARD_SOFT_MAX,
  T_COMPUTE_FORWARD_SOFT_MAX_BACK,
  T_COMPUTE_FORWARD_ROPE,
  T_COMPUTE_FORWARD_ROPE_BACK,
  T_COMPUTE_FORWARD_ROLL,
  T_COMPUTE_FORWARD_CLAMP,
  T_COMPUTE_FORWARD_CONV_TRANSPOSE_1D,
  T_COMPUTE_FORWARD_IM2COL,
  T_COMPUTE_FORWARD_IM2COL_BACK,
  T_COMPUTE_FORWARD_IM2COL_3D,
  T_COMPUTE_FORWARD_CONV_2D,
  T_COMPUTE_FORWARD_CONV_3D,
  T_COMPUTE_FORWARD_CONV_2D_DW,
  T_COMPUTE_FORWARD_CONV_TRANSPOSE_2D,
  T_COMPUTE_FORWARD_POOL_1D,
  T_COMPUTE_FORWARD_POOL_2D,
  T_COMPUTE_FORWARD_POOL_2D_BACK,
  T_COMPUTE_FORWARD_UPSCALE,
  T_COMPUTE_FORWARD_PAD,
  T_COMPUTE_FORWARD_PAD_REFLECT_1D,
  T_COMPUTE_FORWARD_ARANGE,
  T_COMPUTE_FORWARD_TIMESTEP_EMBEDDING,
  T_COMPUTE_FORWARD_ARGSORT,
  T_COMPUTE_FORWARD_LEAKY_RELU,
  T_COMPUTE_FORWARD_FLASH_ATTN_EXT,
  T_COMPUTE_FORWARD_FLASH_ATTN_BACK,
  T_COMPUTE_FORWARD_SSM_CONV,
  T_COMPUTE_FORWARD_SSM_SCAN,
  T_COMPUTE_FORWARD_WIN_PART,
  T_COMPUTE_FORWARD_WIN_UNPART,
  T_COMPUTE_FORWARD_UNARY,
  T_COMPUTE_FORWARD_GET_REL_POS,
  T_COMPUTE_FORWARD_ADD_REL_POS,
  T_COMPUTE_FORWARD_MAP_UNARY,
  T_COMPUTE_FORWARD_MAP_BINARY,
  T_COMPUTE_FORWARD_MAP_CUSTOM1_F32,
  T_COMPUTE_FORWARD_MAP_CUSTOM2_F32,
  T_COMPUTE_FORWARD_MAP_CUSTOM3_F32,
  T_COMPUTE_FORWARD_MAP_CUSTOM1,
  T_COMPUTE_FORWARD_MAP_CUSTOM2,
  T_COMPUTE_FORWARD_MAP_CUSTOM3,
  T_COMPUTE_FORWARD_CROSS_ENTROPY_LOSS,
  T_COMPUTE_FORWARD_CROSS_ENTROPY_LOSS_BACK,
  T_COMPUTE_FORWARD_NONE,
  T_COMPUTE_FORWARD_COUNT,
  T_COMPUTE_FORWARD_SIN,
  T_COMPUTE_FORWARD_COS,
  T_COMPUTE_FORWARD_COUNT_EQUAL,
  T_COMPUTE_FORWARD_L2_NORM,
  T_COMPUTE_FORWARD_RWKV_WKV6,
  T_COMPUTE_FORWARD_GATED_LINEAR_ATTN,
  T_COMPUTE_FORWARD_RWKV_WKV7,
  T_COMPUTE_FORWARD_CUSTOM,
  T_COMPUTE_FORWARD_OPT_STEP_ADAMW,
  T_COMPUTE_FORWARD_OPT_STEP_SGD,
  MONITOREND} monitor_types;

#define MAX_NTHREAD 8

#ifdef  __cplusplus
}
#endif

